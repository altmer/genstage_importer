# genstage_importer

Demo project showing a concept of CSV import with GenStage/Flow data pipeline in Elixir.
This is an illustration for a blogpost in Kloeckner's dev blog.
CSV files to import are [products.csv](./files/products.csv) and [orders.csv](./files/orders.csv).

## Setup

Requirements:

* [docker](https://www.docker.com)
* [docker-compose](https://docs.docker.com/compose/)

```bash
$ docker-compose up -d --build
```

Create a database:

```bash
$ docker-compose exec app mix ecto.setup
```

To run the sync:

```bash
$ docker-compose exec app iex -S mix
iex(1) > GenstageImporter.Pipeline.Product.import()
```

## Generate test data

Requirements:

* [ruby](https://www.ruby-lang.org/en/)

Edit script `files/gen_csv.rb`:

```ruby
PRODUCTS_NUMBER = 1_000 # set number of products in CSV file here
```

Then run it:

```bash
$ ./files/gen_csv.rb
```

It will replace existing CSV files in `./files` folder with new autogenerated data.